.TH "spmfilter.conf" "5" "30 July 2009" "" ""

.SH "NAME"
.P
spmfilter.conf - configuration file for spmfilter
.SH "SYNOPSIS"
.P
spmfilter.conf

.SH "DESCRIPTION"
.P
The \fBspmfilter.conf\fR file is the runtime configuration file for 
\fBspmfilter\fR(1).
.P
The \fBspmfilter.conf\fR file controls available modules, logging, header
checking and delivery options.

.SH "FILE FORMAT"
.P
The file consists of modules and parameters. A module begins with the
name of the module in square brackets and continues until the next
module begins. Modules contain parameters of the form \(lqname = value\(rq.
.P
The file is line-based \(em that is, each newline-terminated line represents
either a comment, a module name or a parameter.
.P
Only the first equals sign in a parameter is significant. Whitespace before
or after the first equals sign is discarded. Leading, trailing and internal
whitespace in module and parameter names is irrelevant. Leading and
trailing whitespace in a parameter value is discarded. Internal whitespace
within a parameter value is retained verbatim.
.P
Any line beginning with a hash (#) is ignored, as are lines containing
only whitespace.
.P
Any line ending in a \e is \(lqcontinued\(rq on the next line in the
customary UNIX fashion.
.P
The values following the equals sign in parameters are all either a string
(no quotes needed) or a boolean, which may be given as true/false. Case is 
not significant in boolean values, but is preserved in string values.

.SH "SECTIONS"
.SS "The [global] section"
.P
Parameters in this section are global and do not affect any modules.

.IP "\fBengine \fR" 
The "engine" option allows you to specify the spmfilter engine. It's
possible to switch the engine for receiving mails. There are two engines
in spmfilter for receiving emails:

.nf
\fBsmtpd\fR - This engine allows to inject emails via smtp to
spmfilter. But please note, with this engine, spmfilter has to be
started with inetd, Postfix or similar TCP server programs.

\fBpipe\fR - The pipe engine lets you inject emails via shell
pipe to spmfilter. This is usefully, when you don't need a full
smtp server.
.fi

.IP "\fBdebug\fR" 
Enables verbose debugging output. Debugging output will be written to
the configured syslog facility.

.IP "\fBmodules\fR"
Specifies all modules, which will be loaded at runtime. All modules
will be process in the same order, as listed. Modules names have to
be separated by a semicolon.

.IP "\fBmodule_fail\fR"
If one module fails, the behaviour of spmfilter can be configured. 
Possible values are:

.nf
1 = proceed and ignore
2 = cancel further processing and return permanet error
3 = cancel further processing and return temporary error (default)
.fi

.IP "\fBnexthop\fR"
This parameter specifies the final destination, after a mail is processed
by spmfilter. The value can be a hostname or IP address, with a port number,
e.g. localhost:2525 to send filtered mails to localhost at port 2525.

.IP "\fBbackend\fR"
Define lookup backend, this can be either \fBsql\fR or \fBldap\fR. Every
backend has it's own config section, \fB[sql]\fR and \fB[ldap]\fR.

.IP "\fBbackend_connection\fR"
If there are multiple server configured in the specified backend, it's
possible to define a failover or load-balancing behaviour. Possible 
values are:

.nf
balance	=	when you configure the backend profile for load balancing, spmfilter 
			distributes connections across the list of hosts. If the actual host is 
			not reachable, spmfilter switches back to failover configuration.
.fi


.nf
failover	=	when you configure the backen profile for failover, spmfilter fails over 
			to the next host in the list if it cannot connect to the first host.
.fi

.SS "The [smtpd] section"
.P
Parameters in this section affect the smtpd engine and smtp delivery.

.IP "\fBnexthop_fail_code\fR"
If the delivery to the final destination fails for any reason, this code is 
used as response to the sending MTA (default 451).

.IP "\fBnexthop_fail_msg\fR"
If the delivery to the final destination fails for any reason, this message 
is used as reponse for the sending MTA.
(default "Requested action aborted: local error in processing").

.P
If you ever need to define SMTP response messages for other error codes, such as 500, than it's possible to configure
these in the smtpd section. The following example will configure spmfilter to send the message "Customized error message" 
with a 500 error code:

.nf
[smtpd]
500=Customized error message.
.fi

.SS "The [sql] section"
Parameters in this section affect the \fBsql backend\fR configuration.
.IP "\fBdriver\fR"
SQl database driver. Supported drivers are mysql, pgsql, sqlite.

.IP "\fBhost\fR"
List of available database hosts, separated by a semicolon. Set to localhost if database is on the same 
host as spmfilter.

.IP "\fBport\fR"
TCP/IP port of database host, if the database is running on a non-standard port.

.IP "\fBname\fR"
Database name, or path to database if driver is set to sqlite.

.IP "\fBuser\fR"
Database username.

.IP "\fBpass\fR"
Database password.

.IP "\fBencoding\fR"
Encoding to match database/table encoding, e.g., latin1, utf8

.SH "EXAMPLE"
.P
What follows is a sample configuration file:

.nf
[global]
engine = smtpd
debug = true
modules=dkim;spam
nexthop = localhost:2525
.fi 
 

The \fBglobal\fR section specifies that smtpd module should be used as engine; debugging is active;
the modules dkim and spam should be loaded; and filtered mails are delivered
to localhost port 2525.

.SH "FILES" 
.P
/etc/spmfilter\&.conf or spmfilter\&.conf
 
.SH "BUGS"
.P
Please report bugs! The spmfilter bug tracking system is available at
http://www.spmfilter.org

.SH "SEE ALSO" 
.P
spmfilter(1)

.SH "AUTHOR(s)" 
.P
spmfilter was written by Axel Steiner <ast@treibsand.com>

